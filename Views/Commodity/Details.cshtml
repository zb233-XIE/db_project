@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
}

@{
    ViewData["Title"] = "Details";
}

<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<link rel="stylesheet" href="https://www.jq22.com/jquery/font-awesome.4.7.0.css">
<link href="~/css/Commodity.css" type="text/css" rel="stylesheet" />
<script type="text/javascript" src="~/js/Commodity.js"></script>
<html>
<head>
     <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    <title>商品详情页面</title>
</head>
<body>
    <div id="Commodity">

        <div id="preview">
            <div>
                <img height="300" width="500" src="@ViewData["PictureURL"]">
            </div>
        </div>

        
        <div id="detailInfo">
            <div id="allin">
                <input id="ID" type="text" value="商品ID:@ViewData["CommodityID"]">
                <div id="Name">@ViewData["CommodityName"]</div>
                <br/>
                <br/>
                <div id="Description">@ViewData["Description"]</div>
                <div class="LowestPrice">
                    <span>史低价格：</span>
                    <i>@ViewData["LowestPrice"]</i>￥
                </div>
                <div class="Price">
                    <span>游戏售价：</span>
                    <i>@ViewData["Price"]</i>￥
                </div>
                <div id="PublishTime">发行时间：@ViewData["PublishTime"]</div>
                <div id="PublisherName">发行商：@ViewData["PublisherName"]</div>
                <div id="SalesVolume">销量：@ViewData["SalesVolume"]</div>
                <div id="DownLoadURL">下载链接：@ViewData["DownLoadURL"]</div>
            </div>

            <div class=" btn">
                <a id="add1" onclick="addToShoppingCart()">加入购物车</a>
               <!-- <a id="add2" onclick="addToWishList()">加入愿望单</a>-->
            </div>
        </div>


        <div id="comment">
            <textarea name="content" id="content" rows="6" cols="61" onpropertychange="if(this.scrollHeight>80) this.style.posHeight=this.scrollHeight+5"
                      onKeyDown="textdown(event)" onKeyUp="textup()" onfocus="if(value=='写下您的评论...'){value=''}" onblur="if (value ==''){value='写下您的评论...'}">写下您的评论...</textarea>
            <div id="commentbtn"><button class="btn" onclick="addEvaluation()" width="20%">发表评论</button></div>

            <div>
                <ul class="allcomment">
                    <li v-for="(item,index) in Description">
                        <span class="ETime">&emsp;&emsp;{{EvaluationID[index]}}：</span>
                        <textarea readonly style="border:0;border-radius:5px;width: 355px;height: 100px;
                        padding: 10px;resize: none;" rows="6" cols="61" type="text" class="Des" :value="Description[index]"></textarea>
                       
                    </li>
                </ul>
            </div>


        </div>

    </div>
</body>
</html>

<script>
    document.getElementById("ID").setAttribute('readonly', true);

    var app = new Vue({
        el: "#comment",
        data: {
            EvaluationID: [],
            Description: []
        },
        mounted: function () {
            this.initial();
            this.tt();
        },
        methods: {
            test: function () { alert("how"); },
            initial: function () {
                console.log("ok");
                var arr;
                var that = this;
                axios.post("/Commodity/DisplayEvaluation"+"?CommodityID="+@ViewData["CommodityID"],{CommodityID:@ViewData["CommodityID"]}).then(function (response) {
                    console.log("data:"+response.data);
                    arr = response.data;
                    let len = arr.length;
                    console.log("length:" + len);
                    var arr1 = new Array(len);
                    var arr2 = new Array(len);
                    for (var i = 0; i < len; i++) {
                        arr1[i] = response.data[i].EvaluationID;
                        arr2[i] = response.data[i].Description;
                    }
                    that.EvaluationID = arr1;
                    that.Description = arr2;
                    //console.log(that.EvaluationID);
                    //console.log(that.Description);
                }, function (err) { });
            },
            tt:function(){
                console.log(this.EvaluationID);
                console.log(this.Description);
            }
        }
    })
</script>